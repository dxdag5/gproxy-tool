# ğŸ“˜ GProxy ä½¿ç”¨æ–‡æ¡£

**GProxy** æ˜¯ä¸€ä¸ªåŸºäº SSH éš§é“çš„è½»é‡çº§ç½‘ç»œåŠ é€Ÿå·¥å…·ã€‚å®ƒåˆ©ç”¨æµ·å¤–æœåŠ¡å™¨ä½œä¸ºè·³æ¿ï¼Œé€šè¿‡ SOCKS5 åè®®å’Œç¯å¢ƒå˜é‡æ³¨å…¥ï¼Œä¸ºå‘½ä»¤è¡Œå·¥å…·ï¼ˆå¦‚ curl, wget, git, docker ç­‰ï¼‰æä¾›è‡ªåŠ¨åŒ–çš„ç½‘ç»œåŠ é€Ÿã€‚

## âœ¨ æ ¸å¿ƒç‰¹æ€§

* **è‡ªå¸¦å¯†é’¥ (BYOK)**ï¼šç›´æ¥ä½¿ç”¨ç°æœ‰çš„æœåŠ¡å™¨ç§é’¥ï¼Œæ— éœ€é‡æ–°é…ç½®äº’ä¿¡
* **æ™ºèƒ½å¯†é’¥å‘ç°**ï¼šè‡ªåŠ¨æ‰«æé¡¹ç›® config ç›®å½•ä¸‹çš„å¯†é’¥æ–‡ä»¶ï¼Œæ— éœ€æ‰‹åŠ¨è¾“å…¥è·¯å¾„
* **Dropbear å…¼å®¹**ï¼šè‡ªåŠ¨å°† OpenSSH PEM å¯†é’¥è½¬æ¢ä¸º Dropbear æ ¼å¼ï¼Œå®Œç¾æ”¯æŒ iStore
* **æŒ‰éœ€è¿æ¥**ï¼šä»…åœ¨æ‰§è¡Œå‘½ä»¤æ—¶å»ºç«‹è¿æ¥ï¼Œå‘½ä»¤ç»“æŸç«‹å³æ–­å¼€
* **é›¶ä¾µå…¥**ï¼šä¸ä¿®æ”¹ç³»ç»Ÿå…¨å±€ä»£ç†è®¾ç½®ï¼Œä¸æ®‹ç•™åå°è¿›ç¨‹
* **é…ç½®æŒä¹…åŒ–**ï¼šä¸€æ¬¡é…ç½®ï¼Œæ°¸ä¹…ä½¿ç”¨
* **è·¨å¹³å°**ï¼šåŒæ—¶æ”¯æŒæ ‡å‡† Linux å’Œ iStore (OpenWrt)

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
gproxy-tool/
â”œâ”€â”€ bin/
â”‚   â””â”€â”€ gproxy           # ä¸»å…¥å£è„šæœ¬
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ common.sh        # å…¬å…±å‡½æ•°ï¼ˆæ—¥å¿—ã€å¹³å°æ£€æµ‹ã€æƒé™ç®¡ç†ï¼‰
â”‚   â”œâ”€â”€ config.sh        # é…ç½®ç®¡ç†ï¼ˆå‘å¯¼ã€å¯†é’¥å‘ç°ã€åŠ è½½ã€é‡ç½®ï¼‰
â”‚   â””â”€â”€ tunnel.sh        # éš§é“ç®¡ç†ï¼ˆSSH é€‚é…ã€å¯†é’¥è½¬æ¢ã€ç«¯å£æ£€æµ‹ï¼‰
â”œâ”€â”€ config/
â”‚   â””â”€â”€ *.pem            # å¯†é’¥æ–‡ä»¶ï¼ˆè‡ªåŠ¨å‘ç°ç›®å½•ï¼‰
â”œâ”€â”€ install.sh           # å®‰è£…è„šæœ¬
â”œâ”€â”€ uninstall.sh         # å¸è½½è„šæœ¬
â””â”€â”€ README.md            # æœ¬æ–‡æ¡£
```

---

## ğŸ› ï¸ å®‰è£…è¯´æ˜

### æ ‡å‡† Linux

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/xtianowner/gproxy-tool.git
cd gproxy-tool

# ä¸€é”®å®‰è£…ï¼ˆéœ€è¦ root æˆ– sudo æƒé™ï¼‰
sudo sh install.sh
```

### iStore (OpenWrt)

```bash
# ä¸Šä¼ é¡¹ç›®åˆ°è®¾å¤‡å
cd /path/to/gproxy-tool

# ç›´æ¥ä»¥ root è¿è¡Œå®‰è£…
sh install.sh
```

> **æç¤º**ï¼šiStore ä¸Šä¸éœ€è¦ `sudo`ï¼Œé»˜è®¤ä»¥ root èº«ä»½è¿è¡Œã€‚

### å®‰è£…ä½ç½®

| æ–‡ä»¶ | å®‰è£…è·¯å¾„ |
|------|---------|
| ä¸»è„šæœ¬ | `/usr/bin/gproxy` |
| åŠŸèƒ½æ¨¡å— | `/usr/lib/gproxy/*.sh` |
| å¯†é’¥æ–‡ä»¶ | `/usr/lib/gproxy/config/` |
| é…ç½®æ–‡ä»¶ | `~/.config/gproxy/config.env`ï¼ˆé¦–æ¬¡è¿è¡Œæ—¶åˆ›å»ºï¼‰ |

---

## âš™ï¸ åˆå§‹åŒ–é…ç½®

é¦–æ¬¡è¿è¡Œä»»ä½•å‘½ä»¤æ—¶ï¼Œå·¥å…·ä¼šè‡ªåŠ¨è¿›å…¥äº¤äº’å¼é…ç½®å‘å¯¼ï¼š

```bash
gproxy curl -I https://www.google.com
```

**é…ç½®æµç¨‹ï¼š**

1. **æµ·å¤–æœåŠ¡å™¨ IP**ï¼šä¾‹å¦‚ `1.2.3.4`
2. **ç”¨æˆ·å**ï¼šé€šå¸¸æ˜¯ `root`ï¼ˆç›´æ¥å›è½¦ä½¿ç”¨é»˜è®¤å€¼ï¼‰
3. **SSH ç«¯å£**ï¼šé»˜è®¤ `22`ï¼ˆç›´æ¥å›è½¦ä½¿ç”¨é»˜è®¤å€¼ï¼‰
4. **ç§é’¥æ–‡ä»¶**ï¼š
   - ğŸ” **è‡ªåŠ¨å‘ç°**ï¼šè„šæœ¬ä¼šè‡ªåŠ¨æ‰«æ `config/` ç›®å½•ä¸‹çš„å¯†é’¥æ–‡ä»¶ï¼ˆ`.pem`ã€`id_rsa` ç­‰ï¼‰ï¼Œæ‰¾åˆ°åæç¤ºç¡®è®¤ï¼Œ**ç›´æ¥å›è½¦å³å¯ä½¿ç”¨**
   - âœï¸ **æ‰‹åŠ¨è¾“å…¥**ï¼šä»…åœ¨è‡ªåŠ¨å‘ç°å¤±è´¥æ—¶æ‰éœ€è¦æ‰‹åŠ¨è¾“å…¥è·¯å¾„

> **æç¤º**ï¼šå°†ä½ çš„ VPS ç§é’¥æ–‡ä»¶æ”¾å…¥é¡¹ç›®çš„ `config/` ç›®å½•ï¼Œå³å¯å®ç°é›¶äº¤äº’çš„å¯†é’¥é…ç½®ã€‚

---

## ğŸš€ ä½¿ç”¨æ–¹å¼å¤§å…¨

### 1. åŸºç¡€ç”¨æ³•

åœ¨ä»»ä½•å‘½ä»¤å‰åŠ ä¸Š `gproxy` å³å¯ï¼š

```bash
# ä¸‹è½½æ–‡ä»¶
gproxy wget https://github.com/xxxx/release.zip

# æµ‹è¯•ç½‘ç»œ
gproxy curl ipinfo.io
```

### 2. Git åŠ é€Ÿï¼ˆæœ€å¸¸ç”¨ï¼‰

```bash
gproxy git clone https://github.com/huggingface/transformers.git
```

### 3. Docker æ‹‰å–é•œåƒ

```bash
gproxy docker pull alpine:latest
```

### 4. åŒ…ç®¡ç†å™¨åŠ é€Ÿ

```bash
# Python pip
gproxy pip install openai

# Ubuntu/Debian apt
gproxy bash -c "apt update && apt install -y vim"

# OpenWrt opkg
gproxy opkg update
```

### 5. ç®¡ç†ä¸é‡ç½®

```bash
# é‡æ–°é…ç½®æœåŠ¡å™¨ä¿¡æ¯
gproxy --config

# æŸ¥çœ‹å¸®åŠ©
gproxy --help
```

---

## ğŸ’¡ é«˜çº§åœºæ™¯ï¼šå¤åˆå‘½ä»¤

å¯¹äº `bash <(curl ...)` è¿™ç§å¤åˆå‘½ä»¤ï¼Œéœ€è¦ç”¨ `bash -c` åŒ…è£¹ï¼š

### âŒ é”™è¯¯ç”¨æ³•

```bash
# curl ä¼šåœ¨ä»£ç†å¯åŠ¨å‰æ‰§è¡Œï¼Œå¯¼è‡´ä¸‹è½½å¤±è´¥
gproxy bash <(curl -sL https://...) ...
```

### âœ… æ­£ç¡®ç”¨æ³•

```bash
# å°†æ•´ä¸ªå‘½ä»¤ä¼ ç»™ bash -cï¼Œè®© curl åœ¨ä»£ç†ç¯å¢ƒä¸­æ‰§è¡Œ
gproxy bash -c "bash <(curl -sL https://raw.githubusercontent.com/xxx/install.sh) -args"
```

**åŸç†**ï¼š`gproxy` å…ˆå»ºç«‹éš§é“ â†’ è®¾ç½®ä»£ç†ç¯å¢ƒ â†’ `bash -c` åœ¨ä»£ç†ç¯å¢ƒä¸­æ‰§è¡Œ â†’ å†…éƒ¨çš„ `curl` å¯ä»¥æ­£å¸¸è®¿é—®ã€‚

---

## ğŸ”§ å¹³å°å…¼å®¹æ€§

| ç‰¹æ€§ | æ ‡å‡† Linux | iStore (OpenWrt) |
|------|-----------| ----------------|
| Shell | sh / bash / zsh | ash (BusyBox) |
| SSH å®¢æˆ·ç«¯ | openssh âœ… | openssh âœ…ï¼ˆè‡ªåŠ¨å®‰è£…ï¼‰ |
| å¯†é’¥æ ¼å¼ | PEM ç›´æ¥ä½¿ç”¨ | PEM ç›´æ¥ä½¿ç”¨ |
| ç«¯å£æ£€æµ‹ | ss / netstat / lsof | ss / netstat / /proc/net/tcp |
| å®‰è£…æ–¹å¼ | `sudo sh install.sh` | `sh install.sh` |

> GProxy ä¼šè‡ªåŠ¨æ£€æµ‹å½“å‰ç¯å¢ƒï¼Œé€‰æ‹©å¯ç”¨çš„å·¥å…·ï¼Œæ— éœ€æ‰‹åŠ¨é…ç½®ã€‚

### iStoreOS é‡è¦è¯´æ˜

iStoreOS é»˜è®¤çš„ Dropbear SSH å®¢æˆ·ç«¯**ä¸æ”¯æŒ `-D` SOCKS5 åŠ¨æ€è½¬å‘**ï¼ˆGProxy çš„æ ¸å¿ƒåŠŸèƒ½ä¾èµ–æ­¤ç‰¹æ€§ï¼‰ã€‚GProxy çš„å¤„ç†ç­–ç•¥ï¼š

1. **è‡ªåŠ¨æ£€æµ‹**ï¼šä¼˜å…ˆæŸ¥æ‰¾ OpenSSH å®¢æˆ·ç«¯
2. **è‡ªåŠ¨å®‰è£…**ï¼šå¦‚æœä»…æœ‰ Dropbearï¼Œä¼šè‡ªåŠ¨é€šè¿‡ `opkg` å®‰è£… `openssh-client`
3. **é™çº§æç¤º**ï¼šå¦‚æœè‡ªåŠ¨å®‰è£…å¤±è´¥ï¼Œç»™å‡ºæ‰‹åŠ¨å®‰è£…æŒ‡å¼•

å¦‚éœ€æ‰‹åŠ¨å®‰è£…ï¼š
```bash
opkg update && opkg install openssh-client
```

---

## ğŸ—‘ï¸ å¸è½½

```bash
# æ ‡å‡† Linux
sudo sh uninstall.sh

# iStore (OpenWrt)
sh uninstall.sh
```

å¸è½½æ—¶ä¼šè¯¢é—®æ˜¯å¦åŒæ—¶åˆ é™¤é…ç½®æ–‡ä»¶ã€‚

---

## â“ å¸¸è§é—®é¢˜æ’æŸ¥

**Q: iStore ä¸Šæç¤º "String too long" æˆ–è¿æ¥æ— å“åº”ï¼Ÿ**

* **A**: iStoreOS é»˜è®¤çš„ Dropbear SSH å®¢æˆ·ç«¯ä¸æ”¯æŒ SOCKS5 ä»£ç†åŠŸèƒ½ã€‚GProxy ä¼šè‡ªåŠ¨å®‰è£… `openssh-client`ã€‚å¦‚æœè‡ªåŠ¨å®‰è£…å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨æ‰§è¡Œï¼š`opkg update && opkg install openssh-client`ã€‚

**Q: æç¤º "Permission denied (publickey)"ï¼Ÿ**

* **A**: æ£€æŸ¥ä½ çš„ç§é’¥æ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®ï¼Œä»¥åŠè¯¥ç§é’¥æ˜¯å¦å¯¹åº”é‚£å°æµ·å¤–æœåŠ¡å™¨ã€‚

**Q: æç¤º "bind: Address already in use"ï¼Ÿ**

* **A**: æœ¬åœ°ä»£ç†ç«¯å£ï¼ˆé»˜è®¤ 19527ï¼‰è¢«å ç”¨ã€‚å¯ç¼–è¾‘ `lib/tunnel.sh`ï¼Œä¿®æ”¹ `LOCAL_PORT` å˜é‡ã€‚

**Q: è„šæœ¬æ‰§è¡Œä¸€åŠæŒ‰ Ctrl+C ä¼šæ€æ ·ï¼Ÿ**

* **A**: è„šæœ¬å†…ç½®äº†ä¿¡å·æ•è·ï¼ˆTrapï¼‰ï¼Œä¼šè‡ªåŠ¨å…³é—­åå°çš„ SSH éš§é“è¿›ç¨‹ï¼Œä¸ä¼šæ®‹ç•™åƒµå°¸è¿›ç¨‹ã€‚

**Q: iStore ä¸Šæç¤º "æœªæ‰¾åˆ° SSH å®¢æˆ·ç«¯"ï¼Ÿ**

* **A**: è¯·å®‰è£… openssh-client æˆ–ç¡®è®¤ dropbear å·²å®‰è£…ï¼š`opkg install openssh-client` æˆ– `opkg install dropbear`ã€‚

**Q: iStore ä¸Šå¦‚ä½•ä¸Šä¼ é¡¹ç›®æ–‡ä»¶ï¼Ÿ**

* **A**: å¯ä»¥ä½¿ç”¨ `scp` å‘½ä»¤ï¼š`scp -r gproxy-tool/ root@<istore-ip>:/tmp/`ï¼Œç„¶ååœ¨è®¾å¤‡ä¸Š `cd /tmp/gproxy-tool && sh install.sh`ã€‚
